# 第6章 Linux文件与目录管理

## 目录的相关操作

特殊目录：

- `./..` 当前/上一个
- `-` 前一个
- `~` 目前使用账号的家目录
- `~account` 账号account的家目录

加入环境变量：`PATH="${PATH}:/dirname"`

命令：

### 列出信息

- `ls -a`：全部文件连通隐藏文件一起列出
- `ls -A`：全部文件连隐藏文件，不含`.`或`..`
- `ls -d`：全部目录不含文件

### 复制、删除和移动

- `cp -a`：服饰全部信息
- `cp -i`：若目标文件已存在则覆盖前询问操作的进行
- `cp -p`：连同属性一起备份过去
- `cp -r`：递归复制，用于复制目录
- `cp -s`：用于产生链接文件（快捷方式）

除了符号链接（快捷方式），还有一种硬链接。

- `rm -f`：强制删除，忽略不存在的文件
- `rm -I`：交互模式，删除前询问是否要操作
- `rm -r`：递归删除目录

- `mv -f`：强制
- `mv -i`：目标文件已存在则访问是否覆盖
- `mv -u`：若目标存在且source较新则更新

### 查看文件内容

- `cat`由第一行开始查看文件内容
  - `-b`列出行号，不带空白行
  - `-E`显示行尾
  - `-n`打印行号
  - `-v`列出特殊字符
- `tac`从最后一行开始显示
  - 选项与上一个相同
- `nl`显示的时候同时输出行号
- `more`一页一页显示

  运行过程中使用：
  - `/字符串`：从此处向下查找字符串
  - `:f`：显示文件名和行数
  - `b`：往回翻页（仅对文件有效）

- `less`在`more`基础上加上往前翻页内容

    运行过程中使用：
  - `/字符串`：从此处向下查找字符串
  - `?字符串`：向上查找
  - `b`：往回翻页（仅对文件有效）

- `head`只看前面几行
- `tail`只看后面几行
- `od`以二进制读取

### 数据的截取

- `head`显示前几行
  - `head -n num`截取前num行，若n是负数则不显示最后的-n行
  - `tail -n num`显示后边num行

### 二进制文件

- `od -t TYPE`输出文件
  - `a`使用默认字符
  - `c`使用ASCII
  - `d [size]`十进制输出
  - `f [size]`浮点数输出
  - `o [size]`八进制输出
  - `x [size]`十六进制输出

### 修改文件时间或创建新文件

文件的时间属性：

- `modifivatin time`，又称`mtime`，修改时间
- `status time`，又称`ctime`，状态时间
- `access time`，读取时间

### 文件的隐藏属性

`chattr`：配置文件隐藏属性，`chattr  [+-=] [Option]`

- `+`添加
- `-`减去
- `=`修改
- `a`这个文件只能增加数据，不能删除且修改，仅root有用
- `i`让文件不能被改名、删除、设置链接和写入新的特性
- `s`删除时从硬盘中彻底删除
- `u`与s相反

`lsattr`：显示文件隐藏属性

### 文件的特殊权限

`suid`，在owner的x位，出现该权限，一般用户执行此文件的时候可以暂时获得拥有者的权限。

`sgid`，在group的x位，一般用户执行该文件时会暂时获得用户组的支持。

`sbit`：对目录有效，当目录有该权限时，一个其他用户或用户组即使对文件夹有w和x权限，则也不能删除该文件夹其他用户的文件。在其他人中的x上显示t标志。

当出现空权限（比如没有执行权限的时候给以上特殊权限），则会显示为大写字母。

### 命令与文件的查找

- `which`查找执行文件
  - `which -a command`将所有能在PATH中找到的命令均列出
- `whereis`由特定目录查找文件名
  - `-b`只查找二进制文件
  - `-s`只找source源文件
- `locale`查找文件
  - `-i`忽略大小写差异
  - `-c`仅输出找到的文件数量
  - `-l`仅输出几行
  - `-r`后面接正则表达式
  - `updatedb`更新数据库
- `find`查找文件
  - 格式：`find [path] [option] [action]`
  - `find xxx -exec command`对找到的文件执行某个操作

### 权限与命令的复习

- 用户进入某目录成为可工作目录，需要至少x权限，想要ls还需要r权限。
- 用户在目录读取一个文件，目录需要x，文件需要r权限。
- 修改一个文件，目录至少需要x权限，文件至少需要r和w权限。
- 目录中新建文件，目录需要w和x权限。
- 用户进入某个目录执行文件，目录和文件都至少需要x权限。
